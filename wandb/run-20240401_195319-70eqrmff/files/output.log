
  0%|                                                                                              | 0/25983 [00:00<?, ?it/s]

  0%|                                                                                  | 1/25983 [00:40<289:18:14, 40.09s/it]

  0%|                                                                                  | 2/25983 [00:50<162:49:15, 22.56s/it]

  0%|                                                                                  | 3/25983 [00:56<107:01:55, 14.83s/it]

  0%|                                                                                   | 4/25983 [01:07<98:30:36, 13.65s/it]

  0%|                                                                                   | 5/25983 [01:09<66:15:37,  9.18s/it]
{'loss': 8.5497, 'grad_norm': 6.935256481170654, 'learning_rate': 1.1542901115813775e-08, 'epoch': 0.0}

  0%|                                                                                   | 7/25983 [01:15<40:52:28,  5.66s/it]

  0%|                                                                                   | 8/25983 [01:21<41:33:03,  5.76s/it]

  0%|                                                                                   | 9/25983 [01:22<31:38:59,  4.39s/it]

  0%|                                                                                  | 10/25983 [01:24<25:05:06,  3.48s/it]

  0%|                                                                                  | 11/25983 [01:35<41:18:32,  5.73s/it]

  0%|                                                                                  | 12/25983 [01:36<32:20:36,  4.48s/it]

  0%|                                                                                  | 13/25983 [01:48<48:43:18,  6.75s/it]

  0%|                                                                                  | 14/25983 [01:50<37:03:54,  5.14s/it]

  0%|                                                                                  | 15/25983 [02:01<50:59:27,  7.07s/it]

  0%|                                                                                  | 16/25983 [02:02<38:25:17,  5.33s/it]

  0%|                                                                                  | 18/25983 [02:15<39:05:33,  5.42s/it]
{'loss': 7.8578, 'grad_norm': 3.9982662200927734, 'learning_rate': 3.462870334744133e-08, 'epoch': 0.0}

  0%|                                                                                  | 19/25983 [02:27<52:51:38,  7.33s/it]

  0%|                                                                                  | 20/25983 [02:28<39:55:59,  5.54s/it]


  0%|                                                                                  | 22/25983 [02:50<54:48:43,  7.60s/it]

  0%|                                                                                  | 23/25983 [02:53<46:48:03,  6.49s/it]
{'loss': 6.4353, 'grad_norm': 0.969668984413147, 'learning_rate': 4.424778761061947e-08, 'epoch': 0.0}

  0%|                                                                                  | 24/25983 [02:59<45:18:18,  6.28s/it]

  0%|                                                                                  | 25/25983 [03:07<49:00:34,  6.80s/it]


  0%|                                                                                  | 27/25983 [03:19<48:23:10,  6.71s/it]
{'loss': 8.1411, 'grad_norm': 4.4027581214904785, 'learning_rate': 5.1943055021161985e-08, 'epoch': 0.0}

  0%|                                                                                  | 28/25983 [03:21<36:42:16,  5.09s/it]

  0%|                                                                                  | 29/25983 [03:33<51:42:04,  7.17s/it]

  0%|                                                                                  | 30/25983 [03:34<38:42:44,  5.37s/it]

  0%|                                                                                  | 31/25983 [03:46<54:06:34,  7.51s/it]

  0%|                                                                                  | 32/25983 [03:48<41:16:47,  5.73s/it]

  0%|                                                                                  | 33/25983 [03:59<53:27:30,  7.42s/it]

  0%|                                                                                  | 34/25983 [04:01<40:54:14,  5.67s/it]

  0%|▏                                                                                                                | 35/25983 [04:13<53:49:50,  7.47s/it]

  0%|▏                                                                                                                | 36/25983 [04:15<41:54:21,  5.81s/it]

  0%|▏                                                                                                                | 37/25983 [04:25<52:34:10,  7.29s/it]

  0%|▏                                                                                                                | 38/25983 [04:27<40:43:19,  5.65s/it]

  0%|▏                                                                                                                | 39/25983 [04:38<52:47:56,  7.33s/it]

  0%|▏                                                                                                                | 40/25983 [04:40<40:22:14,  5.60s/it]

  0%|▏                                                                                | 41/25983 [04:51<53:00:18,  7.36s/it]


  0%|                                                                | 43/25983 [05:04<51:08:44,  7.10s/it]

  0%|                                                                | 44/25983 [05:06<40:13:21,  5.58s/it]
{'loss': 8.2528, 'grad_norm': 5.014246940612793, 'learning_rate': 8.464794151596769e-08, 'epoch': 0.01}

  0%|                                                                | 45/25983 [05:17<53:16:25,  7.39s/it]

  0%|                                                                | 46/25983 [05:19<41:51:56,  5.81s/it]

  0%|                                                                | 47/25983 [05:31<53:58:38,  7.49s/it]


  0%|                                                                | 49/25983 [05:44<53:08:57,  7.38s/it]
{'loss': 6.7117, 'grad_norm': 1.8671916723251343, 'learning_rate': 9.426702577914584e-08, 'epoch': 0.01}

  0%|                                                                | 50/25983 [05:45<40:36:03,  5.64s/it]

  0%|▏                                                               | 51/25983 [05:56<51:32:00,  7.15s/it]

  0%|▏                                                               | 52/25983 [05:58<40:30:36,  5.62s/it]


  0%|                                                        | 54/25983 [06:12<42:13:50,  5.86s/it]
{'loss': 8.1771, 'grad_norm': 4.932058334350586, 'learning_rate': 1.0388611004232397e-07, 'epoch': 0.01}

  0%|                                                    | 55/25983 [06:22<52:07:21,  7.24s/it]

  0%|                                                    | 56/25983 [06:24<40:38:10,  5.64s/it]

  0%|                                                    | 57/25983 [06:35<51:15:36,  7.12s/it]

  0%|                                                    | 58/25983 [06:38<42:09:03,  5.85s/it]

  0%|                                                    | 59/25983 [06:49<53:18:29,  7.40s/it]

  0%|▏                                                                                    | 60/25983 [06:51<42:04:16,  5.84s/it]

  0%|▏                                                                                    | 61/25983 [07:01<52:16:58,  7.26s/it]

  0%|▏                                                                                    | 62/25983 [07:03<39:58:22,  5.55s/it]

  0%|▏                                                                                    | 63/25983 [07:15<53:58:08,  7.50s/it]

  0%|▏                                                                                    | 64/25983 [07:16<40:48:37,  5.67s/it]

  0%|▏                                                                                    | 65/25983 [07:28<52:42:56,  7.32s/it]


  0%|▏                                                                                    | 67/25983 [07:40<51:35:26,  7.17s/it]
{'loss': 7.9314, 'grad_norm': 3.9703547954559326, 'learning_rate': 1.2889572912658716e-07, 'epoch': 0.01}

  0%|▏                                                                                    | 68/25983 [07:42<40:01:35,  5.56s/it]


  0%|▏                                                                                    | 70/25983 [07:56<42:28:55,  5.90s/it]
{'loss': 8.2592, 'grad_norm': 4.748559474945068, 'learning_rate': 1.3466717968449406e-07, 'epoch': 0.01}

  0%|▏                                                                                    | 71/25983 [08:06<52:40:30,  7.32s/it]

  0%|▏                                                                                    | 72/25983 [08:08<41:17:57,  5.74s/it]

  0%|▏                                                                                    | 73/25983 [08:20<52:40:28,  7.32s/it]

  0%|▏                                                                                    | 74/25983 [08:21<40:07:50,  5.58s/it]

  0%|▏                                                                                    | 75/25983 [08:33<53:59:22,  7.50s/it]

  0%|▏                                                                                    | 76/25983 [08:34<40:22:55,  5.61s/it]
{'loss': 7.9847, 'grad_norm': 3.7271671295166016, 'learning_rate': 1.4813389765294344e-07, 'epoch': 0.01}

  0%|▏                                                         | 78/25983 [08:48<40:50:59,  5.68s/it]

  0%|▏                                                               | 79/25983 [08:59<54:08:31,  7.52s/it]


  0%|▏                                                               | 81/25983 [09:12<53:02:22,  7.37s/it]
{'loss': 8.1139, 'grad_norm': 4.400773525238037, 'learning_rate': 1.5582916506348597e-07, 'epoch': 0.01}

  0%|▏                                                               | 82/25983 [09:13<39:57:35,  5.55s/it]

  0%|▏                                                               | 83/25983 [09:25<52:50:49,  7.35s/it]


  0%|▏                                                               | 85/25983 [09:38<53:36:40,  7.45s/it]
{'loss': 8.3411, 'grad_norm': 4.486058712005615, 'learning_rate': 1.6352443247402847e-07, 'epoch': 0.01}

  0%|▏                                                               | 86/25983 [09:40<40:33:26,  5.64s/it]

  0%|▏                                                               | 87/25983 [09:51<53:39:46,  7.46s/it]

  0%|▏                                                               | 88/25983 [09:53<40:19:17,  5.61s/it]

  0%|▏                                                               | 89/25983 [10:05<55:02:10,  7.65s/it]

  0%|▏                                                               | 90/25983 [10:06<41:28:36,  5.77s/it]

  0%|▏                                                               | 91/25983 [10:18<54:04:10,  7.52s/it]

  0%|▏                                                               | 92/25983 [10:19<40:44:09,  5.66s/it]

  0%|▏                                                       | 93/25983 [10:32<55:11:07,  7.67s/it]

  0%|▏                                                       | 94/25983 [10:33<41:27:17,  5.76s/it]


  0%|▏                                                         | 96/25983 [11:26<127:47:49, 17.77s/it]
{'loss': 6.9652, 'grad_norm': 2.5608203411102295, 'learning_rate': 1.846864178530204e-07, 'epoch': 0.01}

  0%|▏                                                          | 97/25983 [11:28<92:42:57, 12.89s/it]

  0%|▏                                                          | 98/25983 [11:32<73:45:20, 10.26s/it]

  0%|▏                                                          | 99/25983 [11:33<54:39:21,  7.60s/it]

  0%|▏                                                         | 100/25983 [11:35<41:08:43,  5.72s/it]

  0%|▏                                                         | 101/25983 [11:46<53:25:27,  7.43s/it]

  0%|▏                                                         | 102/25983 [11:47<40:06:54,  5.58s/it]

  0%|▏                                                         | 103/25983 [11:53<40:26:40,  5.63s/it]


  0%|▏                                                         | 105/25983 [12:06<46:53:34,  6.52s/it]
{'loss': 8.0502, 'grad_norm': 4.161786079406738, 'learning_rate': 2.020007695267411e-07, 'epoch': 0.01}

  0%|▏                                                         | 106/25983 [12:08<36:50:37,  5.13s/it]

  0%|▏                                                         | 107/25983 [12:19<49:43:30,  6.92s/it]

  0%|▏                                                         | 108/25983 [12:21<38:35:47,  5.37s/it]

  0%|▏                                                         | 109/25983 [12:32<51:06:31,  7.11s/it]

  0%|▏                                                         | 110/25983 [12:35<41:18:31,  5.75s/it]


  0%|▎                                                         | 112/25983 [12:48<42:12:22,  5.87s/it]
{'loss': 6.5485, 'grad_norm': 0.7910575866699219, 'learning_rate': 2.1546748749519047e-07, 'epoch': 0.01}

  0%|▎                                                         | 114/25983 [13:00<40:07:16,  5.58s/it]

  0%|▎                                                        | 115/25983 [13:58<153:04:07, 21.30s/it]
{'loss': 6.3311, 'grad_norm': 0.8896743655204773, 'learning_rate': 2.2123893805309737e-07, 'epoch': 0.01}

  0%|▎                                                        | 116/25983 [14:00<110:05:48, 15.32s/it]

  0%|▎                                                         | 118/25983 [14:13<74:04:39, 10.31s/it]
{'loss': 8.0416, 'grad_norm': 3.6818246841430664, 'learning_rate': 2.2701038861100425e-07, 'epoch': 0.01}

  0%|▎                                                         | 119/25983 [14:24<76:43:30, 10.68s/it]

  0%|▎                                                         | 120/25983 [14:25<56:35:53,  7.88s/it]

  0%|▎                                                         | 122/25983 [14:39<48:25:56,  6.74s/it]
{'loss': 8.1977, 'grad_norm': 4.604543685913086, 'learning_rate': 2.3470565602154678e-07, 'epoch': 0.01}

  0%|▎                                                         | 123/25983 [14:50<58:28:02,  8.14s/it]

  0%|▎                                                         | 124/25983 [14:51<44:01:37,  6.13s/it]
{'loss': 8.0267, 'grad_norm': 3.530431032180786, 'learning_rate': 2.404771065794537e-07, 'epoch': 0.01}

  0%|▎                                                         | 126/25983 [15:04<41:44:59,  5.81s/it]

  0%|▎                                                         | 127/25983 [15:16<55:09:27,  7.68s/it]

  0%|▎                                                         | 128/25983 [15:17<41:11:46,  5.74s/it]
{'loss': 6.5173, 'grad_norm': 2.1865477561950684, 'learning_rate': 2.4817237398999613e-07, 'epoch': 0.01}

  1%|▎                                                         | 130/25983 [15:30<39:50:41,  5.55s/it]

  1%|▎                                                         | 131/25983 [15:42<54:14:11,  7.55s/it]


  1%|▎                                                         | 133/25983 [15:55<52:39:37,  7.33s/it]
{'loss': 8.2349, 'grad_norm': 4.611876964569092, 'learning_rate': 2.558676414005387e-07, 'epoch': 0.02}

  1%|▎                                                         | 134/25983 [15:56<39:36:48,  5.52s/it]

  1%|▎                                                         | 136/25983 [16:09<39:31:56,  5.51s/it]
{'loss': 8.0616, 'grad_norm': 3.815096378326416, 'learning_rate': 2.6163909195844556e-07, 'epoch': 0.02}

  1%|▎                                                         | 138/25983 [16:23<41:03:04,  5.72s/it]
{'loss': 8.1088, 'grad_norm': 5.292359828948975, 'learning_rate': 2.654867256637168e-07, 'epoch': 0.02}

  1%|▎                                                         | 140/25983 [16:37<42:15:35,  5.89s/it]
{'loss': 8.144, 'grad_norm': 4.808765411376953, 'learning_rate': 2.693343593689881e-07, 'epoch': 0.02}

  1%|▎                                                         | 141/25983 [16:48<54:33:16,  7.60s/it]

  1%|▎                                                         | 142/25983 [16:50<41:12:03,  5.74s/it]
{'loss': 6.4043, 'grad_norm': 1.2788035869598389, 'learning_rate': 2.75105809926895e-07, 'epoch': 0.02}

  1%|▎                                                         | 144/25983 [17:02<40:16:24,  5.61s/it]

  1%|▎                                                         | 145/25983 [17:14<53:30:02,  7.45s/it]


  1%|▎                                                         | 147/25983 [17:27<51:57:36,  7.24s/it]
{'loss': 7.9986, 'grad_norm': 4.161375045776367, 'learning_rate': 2.828010773374375e-07, 'epoch': 0.02}

  1%|▎                                                         | 148/25983 [17:28<39:11:02,  5.46s/it]
{'loss': 6.4379, 'grad_norm': 0.721962034702301, 'learning_rate': 2.8664871104270875e-07, 'epoch': 0.02}

  1%|▎                                                         | 150/25983 [17:41<39:12:49,  5.46s/it]

  1%|▎                                                         | 151/25983 [17:52<52:07:40,  7.26s/it]


  1%|▍                                                                           | 153/25983 [18:05<51:50:00,  7.22s/it]
{'loss': 7.9998, 'grad_norm': 3.9459269046783447, 'learning_rate': 2.9434397845325125e-07, 'epoch': 0.02}

  1%|▍                                                                           | 154/25983 [18:06<39:30:13,  5.51s/it]

  1%|▍                                                                           | 156/25983 [18:19<39:22:22,  5.49s/it]

  1%|▍                                                                           | 157/25983 [18:31<52:59:38,  7.39s/it]
{'loss': 8.1932, 'grad_norm': 4.37861967086792, 'learning_rate': 3.0203924586379375e-07, 'epoch': 0.02}

  1%|▍                                                                           | 158/25983 [18:32<40:02:47,  5.58s/it]

  1%|▍                                                                           | 159/25983 [18:50<66:42:20,  9.30s/it]


  1%|▍                                                             | 161/25983 [19:03<59:02:47,  8.23s/it]
{'loss': 6.6548, 'grad_norm': 1.3493016958236694, 'learning_rate': 3.097345132743363e-07, 'epoch': 0.02}

  1%|▍                                                             | 162/25983 [19:04<44:04:53,  6.15s/it]

  1%|▎                                                     | 164/25983 [19:17<41:55:58,  5.85s/it]

  1%|▎                                                     | 165/25983 [19:29<54:58:11,  7.66s/it]
{'loss': 6.3877, 'grad_norm': 6.638392925262451, 'learning_rate': 3.174297806848788e-07, 'epoch': 0.02}

  1%|▎                                                     | 166/25983 [19:30<41:13:56,  5.75s/it]
{'loss': 6.1585, 'grad_norm': 0.7786415219306946, 'learning_rate': 3.2127741439015006e-07, 'epoch': 0.02}

  1%|▎                                                     | 168/25983 [19:42<39:41:51,  5.54s/it]

  1%|▎                                                     | 169/25983 [19:54<52:52:49,  7.37s/it]

  1%|▎                                                     | 170/25983 [19:56<40:02:20,  5.58s/it]
{'loss': 7.5826, 'grad_norm': 3.0498874187469482, 'learning_rate': 3.289726818006926e-07, 'epoch': 0.02}

  1%|▎                                                     | 172/25983 [20:09<40:05:08,  5.59s/it]

  1%|▎                                                     | 173/25983 [20:20<53:03:47,  7.40s/it]


  1%|▎                                                     | 175/25983 [20:33<52:18:42,  7.30s/it]
{'loss': 8.0758, 'grad_norm': 4.287389278411865, 'learning_rate': 3.366679492112351e-07, 'epoch': 0.02}


  1%|▎                                                     | 177/25983 [20:45<51:05:58,  7.13s/it]
{'loss': 7.8841, 'grad_norm': 3.323014974594116, 'learning_rate': 3.405155829165064e-07, 'epoch': 0.02}

  1%|▎                                                     | 178/25983 [20:46<38:35:15,  5.38s/it]

  1%|▎                                                     | 180/25983 [20:59<38:31:35,  5.38s/it]
{'loss': 6.3925, 'grad_norm': 0.6712216138839722, 'learning_rate': 3.4628703347441325e-07, 'epoch': 0.02}

  1%|▍                                                     | 181/25983 [21:11<52:15:00,  7.29s/it]


  1%|▍                                                     | 183/25983 [21:23<51:15:46,  7.15s/it]
{'loss': 6.3116, 'grad_norm': 0.7309219241142273, 'learning_rate': 3.520584840323202e-07, 'epoch': 0.02}

  1%|▍                                                     | 184/25983 [21:24<38:49:36,  5.42s/it]

  1%|▍                                                     | 186/25983 [21:37<38:53:27,  5.43s/it]
{'loss': 6.2859, 'grad_norm': 1.8833881616592407, 'learning_rate': 3.5782993459022706e-07, 'epoch': 0.02}
{'loss': 7.8212, 'grad_norm': 3.1764841079711914, 'learning_rate': 3.597537514428627e-07, 'epoch': 0.02}

  1%|▍                                                     | 188/25983 [21:51<40:30:24,  5.65s/it]

  1%|▍                                                     | 190/25983 [22:03<39:40:42,  5.54s/it]
{'loss': 7.9778, 'grad_norm': 4.154663562774658, 'learning_rate': 3.6552520200076956e-07, 'epoch': 0.02}

  1%|▍                                                     | 191/25983 [22:15<52:07:27,  7.28s/it]

  1%|▍                                                     | 192/25983 [22:16<39:13:25,  5.47s/it]
{'loss': 6.8358, 'grad_norm': 6.438374996185303, 'learning_rate': 3.7129665255867644e-07, 'epoch': 0.02}

  1%|▍                                                     | 194/25983 [22:29<39:17:24,  5.48s/it]

  1%|▍                                                     | 195/25983 [22:40<52:36:16,  7.34s/it]

  1%|▍                                                     | 196/25983 [22:42<39:27:23,  5.51s/it]Error in sys.excepthook:
Traceback (most recent call last):
  File "/usr/lib/python3.9/linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
  File "/usr/lib/python3.9/linecache.py", line 137, in updatecache
    lines = fp.readlines()
  File "/usr/lib/python3.9/codecs.py", line 322, in decode
    (result, consumed) = self._buffer_decode(data, self.errors, final)
KeyboardInterrupt
Original exception was:
Traceback (most recent call last):
  File "/home/ubuntu/ejpark/tevatron/src/tevatron/retriever/driver/train.py", line 113, in <module>
    main()
  File "/home/ubuntu/ejpark/tevatron/src/tevatron/retriever/driver/train.py", line 106, in main
    trainer.train()  # TODO: resume training
  File "/home/ubuntu/ejpark/con_venv/lib/python3.9/site-packages/transformers/trainer.py", line 1780, in train
    return inner_training_loop(
  File "/home/ubuntu/ejpark/con_venv/lib/python3.9/site-packages/transformers/trainer.py", line 2085, in _inner_training_loop
    for step, inputs in enumerate(epoch_iterator):
  File "/home/ubuntu/ejpark/con_venv/lib/python3.9/site-packages/accelerate/data_loader.py", line 462, in __iter__
    next_batch = next(dataloader_iter)
  File "/home/ubuntu/ejpark/con_venv/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/ubuntu/ejpark/con_venv/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1328, in _next_data
    idx, data = self._get_data()
  File "/home/ubuntu/ejpark/con_venv/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1284, in _get_data
    success, data = self._try_get_data()
  File "/home/ubuntu/ejpark/con_venv/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1132, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/usr/lib/python3.9/queue.py", line 180, in get
    self.not_empty.wait(remaining)
  File "/usr/lib/python3.9/threading.py", line 316, in wait
    gotit = waiter.acquire(True, timeout)
KeyboardInterrupt